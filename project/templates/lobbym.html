{%extends "layout.html"%}
{%block head%}
	<title>Squircle Lobby</title>
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet", href="{{url_for("static", filename="css/nav-bar.css")}}", type="text/css"/>
	<script type="text/javascript" src="{{url_for("static", filename="bower_components/socket.io-client/dist/socket.io.slim.js")}}"></script>
	<!-- react-->
	<link rel="stylesheet", href="{{url_for("static", filename="css/desktop.css")}}", type="text/css"/>
	<link rel="stylesheet", href="{{url_for("static", filename="css/chat.css")}}", type="text/css"/>

	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/react/15.4.2/react-dom.js"></script>
	<script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/6.21.1/babel.min.js"></script>
	<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/1.3.6/socket.io.min.js"></script>
	<script type="text/javascript">
		var data = null;
		{% if data %}
			data = {{data|safe}};
			var username = data["username"];
			var users = data["users"];
			var players = users["players"];
			var spectators = users["spectators"];
			var numPlayers = data["num_players"];
			var socket;
			{% if code %}
				var lobbycode = "{{code}}";
				socket = io.connect('http://' + document.domain + ':' + location.port);
			
				socket.on('connect', function() {
					socket.emit('join', {'code': lobbycode, 'username':username});
				});
			{% endif %}
		{% endif %}
	</script>
	<script type="text/javascript" src="{{url_for("static", filename="scripts/js/lobbym.js")}}"></script>
{%endblock%}
{%block body%}
	<ul class="nav-bar">
		<li class="nav-bar"><a href="{{ url_for("unlogger") }}">Logout</a></li>
		<li class="nav-bar"><a href="{{ url_for("faq") }}">FAQ</a></li>
	</ul>	

	<div class="text-center">
		<h2 class="text-center" id="lobbycode">Lobby {% if code %} {{code}} {% endif %}</h2>
	</div>

	{% if data %}
	<div id="userslist" style="margin:0 auto;text-align:center;width:80%;max-width:1000px;min-width:400px">
		<div id="players" style="float:left;padding-left:6%;padding-bottom:20px;text-align:left;width:41%;font-size:16px">
		</div>
		<div id="spectators" style="margin-left:51%;padding-left:6%;padding-bottom:20px;text-align:left;width:41%;font-size:16px">
		</div>
		<button id="ready" type="button" class="yellow-button" disabled>I'm Ready</button>
	</div>
	{% else %}
		<div class="text-center">
			<a href="{{url_for("profile")}}">
				<button type="button" class="yellow-button">Join a Lobby</button>
			</a>
		</div>
	{% endif %}
	<!-- for react chat-->
	<div id="chatcontainer" hidden>
		<div id="Chat" >
			{% if data %}
			<script type="text/jsx" src="{{url_for('static', filename='scripts/jsx/chatm.js')}}"></script>

			{% endif %}
		</div>
	</div>
{%endblock%}
{% block tip %}
	{% if data %}
		This is the lobby where your friends and other users wait for the game to start. 
		Once the number of players is reached, the players will tap <strong>I'm Ready</strong>
		to indicate that they are ready, then the game will start!
	{% else %}
		You have not joined a lobby yet. Click on <strong>Join a Lobby</strong> to log in and join a lobby so you can start gaming!
	{% endif %}
{% endblock %}